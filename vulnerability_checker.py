import requests

def check_headers(url):
    print(f"Checking headers for {url}...")
    try:
        response = requests.get(url)
        headers = response.headers
        issues = []
        
        if "X-Frame-Options" not in headers:
            issues.append("Missing X-Frame-Options header (clickjacking risk)")
        if "X-Content-Type-Options" not in headers:
            issues.append("Missing X-Content-Type-Options header (MIME sniffing risk)")
        if "Content-Security-Policy" not in headers:
            issues.append("Missing Content-Security-Policy header")
        
        if issues:
            print("Vulnerabilities found:")
            for i in issues:
                print(f"- {i}")
        else:
            print("No common header issues detected.")
        
        with open("sample_report.txt", "a") as f:
            f.write(f"Vulnerability check for {url}: {issues if issues else 'No issues'}\n")

    except Exception as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    target_url = input("Enter target URL (http/https): ")
    check_headers(target_url)
